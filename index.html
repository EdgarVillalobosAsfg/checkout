function displayTable(data) {
    var headers = Object.keys(data[0]).map(header => header.trim());
    headers = headers.filter(header => !hiddenColumns.includes(header));

    if (headers.includes("Assigned to")) {
        headers = headers.filter(h => h !== "Assigned to");
        headers.unshift("Assigned to"); 
    }

    var table = "<table id='dataTable' class='display'><thead><tr>";

    $.each(headers, function(index, header) {
        table += "<th>" + header + "</th>";
    });

    table += "</tr></thead><tbody>";

    $.each(data, function(key, value) {
        table += "<tr>";
        $.each(headers, function(index, header) {
            var cellData = value[header] || "";

            // Si la columna es "Asset Photo" y el contenido es un link, mostrar la imagen
            if (header.toLowerCase() === "asset photo" && cellData.startsWith("http")) {
                table += "<td><img src='" + cellData + "' width='100' height='100'></td>";
            } else {
                table += "<td>" + cellData + "</td>";
            }
        });
        table += "</tr>";
    });

    table += "</tbody></table>";
    $("#data").html(table);

    // Aplicar DataTables para búsqueda, paginación y ordenación
    $('#dataTable').DataTable({
        "paging": true,  
        "ordering": true,  
        "info": true,  
        "searching": true, 
        "language": {
            "search": "Buscar en la tabla:",
            "lengthMenu": "Mostrar _MENU_ registros por página",
            "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
            "infoEmpty": "No hay registros disponibles",
            "infoFiltered": "(filtrado de _MAX_ registros en total)",
            "paginate": {
                "first": "Primero",
                "last": "Último",
                "next": "Siguiente",
                "previous": "Anterior"
            }
        }
    });
}
